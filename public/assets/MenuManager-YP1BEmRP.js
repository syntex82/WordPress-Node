import{r,j as e}from"./vendor-react-D2QycniR.js";import{bz as m,z as d,j as T,I as L,P as ee,aW as te,a5 as se,a6 as le,v as D,aV as ae,a as ne,F as re,aQ as oe,aP as ie,l as de,y as ce,bi as ue}from"./index-Bwazbld5.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";const xe=[{id:"header",name:"Header Navigation"},{id:"footer",name:"Footer Navigation"},{id:"sidebar",name:"Sidebar Menu"}],me=[{id:"CUSTOM",name:"Custom Link",icon:ae},{id:"PAGE",name:"Page",icon:ne},{id:"POST",name:"Post",icon:re},{id:"HOME",name:"Home",icon:oe},{id:"SHOP",name:"Shop",icon:ie},{id:"PRODUCT",name:"Product",icon:de},{id:"CATEGORY",name:"Category",icon:ce},{id:"LOGIN",name:"Login",icon:ue}];function ve(){const[b,f]=r.useState([]),[o,I]=r.useState(null),[i,u]=r.useState([]),[v,E]=r.useState([]),[j,U]=r.useState([]),[N,R]=r.useState([]),[y,_]=r.useState([]),[G,$]=r.useState(!0),[M,k]=r.useState(!1),[H,h]=r.useState(!1),[z,p]=r.useState(!1),[w,P]=r.useState(""),[O,Y]=r.useState("header"),[g,C]=r.useState(null),[l,c]=r.useState({label:"",url:"",type:"CUSTOM",target:"_self"});r.useEffect(()=>{F()},[]);const F=async()=>{try{const[t,s]=await Promise.all([m.getAll(),m.getAvailableLinks()]);f(t.data),E(s.data.pages),U(s.data.posts),R(s.data.products||[]),_(s.data.productCategories||[]),t.data.length>0&&!o&&S(t.data[0])}catch{d.error("Failed to load menus")}finally{$(!1)}},S=t=>{I(t),u(t.items||[])},B=async()=>{var t,s;if(!w.trim()){d.error("Please enter a menu name");return}try{const a=await m.create({name:w,location:O});f([...b,a.data]),S(a.data),h(!1),P(""),d.success("Menu created successfully")}catch(a){d.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to create menu")}},Q=async()=>{if(o&&confirm("Are you sure you want to delete this menu?"))try{await m.delete(o.id);const t=b.filter(s=>s.id!==o.id);f(t),I(t.length>0?t[0]:null),u(t.length>0?t[0].items:[]),d.success("Menu deleted")}catch{d.error("Failed to delete menu")}},V=async()=>{if(o){k(!0);try{const t=i.map((s,a)=>({label:s.label,url:s.url,target:s.target||"_self",type:s.type,pageId:s.pageId,postId:s.postId,order:a,cssClass:s.cssClass,icon:s.icon}));await m.update(o.id,{items:t}),d.success("Menu saved successfully"),F()}catch{d.error("Failed to save menu")}finally{k(!1)}}},W=()=>{var s,a;if(!((s=l.label)!=null&&s.trim())){d.error("Please enter a label");return}if(l.type==="CUSTOM"&&!((a=l.url)!=null&&a.trim())){d.error("Please enter a URL");return}const t={id:`temp-${Date.now()}`,label:l.label||"",url:l.url||"",type:l.type||"CUSTOM",target:l.target||"_self",pageId:l.pageId,postId:l.postId,order:i.length};if(t.type==="PAGE"&&t.pageId){const n=v.find(x=>x.id===t.pageId);n&&(t.url=`/${n.slug}`)}else if(t.type==="POST"&&t.postId){const n=j.find(x=>x.id===t.postId);n&&(t.url=`/blog/${n.slug}`)}else if(t.type==="HOME")t.url="/";else if(t.type==="SHOP")t.url="/shop";else if(t.type==="PRODUCT"&&l.productId){const n=N.find(x=>x.id===l.productId);n&&(t.url=`/shop/product/${n.slug}`)}else if(t.type==="CATEGORY"&&l.categoryId){const n=y.find(x=>x.id===l.categoryId);n&&(t.url=`/shop?category=${n.slug}`)}else t.type==="LOGIN"&&(t.url="/admin/login");u([...i,t]),p(!1),c({label:"",url:"",type:"CUSTOM",target:"_self"})},X=t=>{u(i.filter((s,a)=>a!==t))},q=(t,s)=>{const a=[...i];a[t]={...a[t],...s},u(a)},J=t=>{C(t)},K=(t,s)=>{if(t.preventDefault(),g===null||g===s)return;const a=[...i],[n]=a.splice(g,1);a.splice(s,0,n),u(a),C(s)},Z=()=>{C(null)},A=(t,s)=>{const a=s==="up"?t-1:t+1;if(a<0||a>=i.length)return;const n=[...i];[n[t],n[a]]=[n[a],n[t]],u(n)};return G?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})}):e.jsxs("div",{className:"min-h-screen bg-slate-900 p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent",children:"Menu Manager"}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-500 hover:to-blue-400 shadow-lg shadow-blue-500/20 transition-all",children:[e.jsx(T,{})," Create Menu"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-4",children:[e.jsx("h2",{className:"font-semibold text-white mb-3",children:"Menus"}),b.length===0?e.jsx("p",{className:"text-slate-400 text-sm",children:"No menus yet. Create one to get started."}):e.jsx("div",{className:"space-y-2",children:b.map(t=>e.jsxs("button",{onClick:()=>S(t),className:`w-full text-left px-3 py-2 rounded-xl transition-all ${(o==null?void 0:o.id)===t.id?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"hover:bg-slate-700/50 text-slate-300 border border-transparent"}`,children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-xs text-slate-500",children:t.location})]},t.id))})]}),e.jsx("div",{className:"lg:col-span-3 bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50",children:o?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-700/50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-white",children:o.name}),e.jsxs("p",{className:"text-sm text-slate-400",children:["Location: ",o.location]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Q,className:"flex items-center gap-1 px-3 py-2 text-red-400 hover:bg-red-500/10 rounded-xl transition-all",children:[e.jsx(L,{})," Delete"]}),e.jsxs("button",{onClick:V,disabled:M,className:"flex items-center gap-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-500 hover:to-blue-400 disabled:opacity-50 shadow-lg shadow-blue-500/20 transition-all",children:[e.jsx(ee,{})," ",M?"Saving...":"Save Menu"]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium text-white",children:"Menu Items"}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-slate-700/50 hover:bg-slate-600/50 text-white rounded-xl transition-all",children:[e.jsx(T,{})," Add Item"]})]}),i.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx("p",{children:"No menu items yet."}),e.jsx("p",{className:"text-sm",children:'Click "Add Item" to add links to this menu.'})]}):e.jsx("div",{className:"space-y-2",children:i.map((t,s)=>e.jsxs("div",{draggable:!0,onDragStart:()=>J(s),onDragOver:a=>K(a,s),onDragEnd:Z,className:`flex items-center gap-3 p-3 bg-slate-700/30 rounded-xl border ${g===s?"border-blue-500/50 bg-blue-500/10":"border-slate-600/50"} transition-all`,children:[e.jsx("div",{className:"cursor-move text-slate-400 hover:text-white transition-colors",children:e.jsx(te,{})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:t.label,onChange:a=>q(s,{label:a.target.value}),className:"font-medium bg-transparent border-none focus:outline-none focus:ring-0 w-full text-white"}),e.jsx("div",{className:"text-xs text-slate-500",children:t.url||"No URL"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>A(s,"up"),disabled:s===0,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30 transition-colors",children:e.jsx(se,{})}),e.jsx("button",{onClick:()=>A(s,"down"),disabled:s===i.length-1,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30 transition-colors",children:e.jsx(le,{})}),e.jsx("button",{onClick:()=>X(s),className:"p-1 text-red-400 hover:text-red-300 transition-colors",children:e.jsx(L,{})})]})]},t.id||s))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64 text-slate-400",children:"Select a menu or create a new one"})})]}),H&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700/50 p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create New Menu"}),e.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-white hover:bg-slate-700/50 p-2 rounded-lg transition-all",children:e.jsx(D,{})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Menu Name"}),e.jsx("input",{type:"text",value:w,onChange:t=>P(t.target.value),placeholder:"e.g., Main Navigation",className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Location"}),e.jsx("select",{value:O,onChange:t=>Y(t.target.value),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:xe.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-xl transition-all",children:"Cancel"}),e.jsx("button",{onClick:B,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-500 hover:to-blue-400 shadow-lg shadow-blue-500/20 transition-all",children:"Create Menu"})]})]})]})}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700/50 p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Add Menu Item"}),e.jsx("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-white hover:bg-slate-700/50 p-2 rounded-lg transition-all",children:e.jsx(D,{})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Type"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:me.map(t=>e.jsxs("button",{onClick:()=>c({...l,type:t.id,pageId:void 0,postId:void 0}),className:`flex flex-col items-center p-2 rounded-xl border transition-all ${l.type===t.id?"border-blue-500/50 bg-blue-500/20 text-blue-400":"border-slate-600/50 hover:bg-slate-700/50 text-slate-300"}`,children:[e.jsx(t.icon,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:t.name})]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:l.label||"",onChange:t=>c({...l,label:t.target.value}),placeholder:"Menu item text",className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),l.type==="CUSTOM"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"URL"}),e.jsx("input",{type:"text",value:l.url||"",onChange:t=>c({...l,url:t.target.value}),placeholder:"https://example.com or /page",className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),l.type==="PAGE"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Page"}),e.jsxs("select",{value:l.pageId||"",onChange:t=>{const s=v.find(a=>a.id===t.target.value);c({...l,pageId:t.target.value,label:l.label||(s==null?void 0:s.title)||""})},className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"",children:"Select a page..."}),v.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})]}),l.type==="POST"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Post"}),e.jsxs("select",{value:l.postId||"",onChange:t=>{const s=j.find(a=>a.id===t.target.value);c({...l,postId:t.target.value,label:l.label||(s==null?void 0:s.title)||""})},className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"",children:"Select a post..."}),j.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})]}),l.type==="PRODUCT"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Product"}),e.jsxs("select",{value:l.productId||"",onChange:t=>{const s=N.find(a=>a.id===t.target.value);c({...l,productId:t.target.value,label:l.label||(s==null?void 0:s.name)||""})},className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"",children:"Select a product..."}),N.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),l.type==="CATEGORY"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Select Category"}),e.jsxs("select",{value:l.categoryId||"",onChange:t=>{const s=y.find(a=>a.id===t.target.value);c({...l,categoryId:t.target.value,label:l.label||(s==null?void 0:s.name)||""})},className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"",children:"Select a category..."}),y.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Open in"}),e.jsxs("select",{value:l.target||"_self",onChange:t=>c({...l,target:t.target.value}),className:"w-full px-3 py-2 bg-slate-700/50 border border-slate-600/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"_self",children:"Same window"}),e.jsx("option",{value:"_blank",children:"New tab"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-xl transition-all",children:"Cancel"}),e.jsx("button",{onClick:W,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-500 hover:to-blue-400 shadow-lg shadow-blue-500/20 transition-all",children:"Add Item"})]})]})]})})]})}export{ve as default};
