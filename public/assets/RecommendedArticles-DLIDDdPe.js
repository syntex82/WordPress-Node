import{r,j as e,L as U}from"./vendor-react-D2QycniR.js";import{u as H,aH as k,z as $,v as _,b as B,S as D,cp as Q,b_ as X,bQ as S,k as C,d as Y,ad as q,i as G}from"./index-Bwazbld5.js";function V({isOpen:n,onClose:i,userId:x,username:d,type:c,isOwnProfile:b}){const{resolvedTheme:P}=H(),t=P==="dark",[g,w]=r.useState([]),[a,o]=r.useState(!0),[p,u]=r.useState(1),[j,f]=r.useState(!0),[l,N]=r.useState({}),[A,L]=r.useState(null);r.useEffect(()=>{n&&(w([]),u(1),f(!0),E(1,!0))},[n,x,c]);const E=async(s,m=!1)=>{var v,h;try{o(!0);const y=d||x,F=c==="followers"?await k.getProfileFollowers(y,s,20):await k.getProfileFollowing(y,s,20),z=F.data.data||F.data||[];w(M=>m?z:[...M,...z]),f(((v=F.data.pagination)==null?void 0:v.page)<((h=F.data.pagination)==null?void 0:h.pages))}catch(y){console.error("Error loading users:",y),$.error(`Failed to load ${c}`)}finally{o(!1)}},R=async s=>{const m=s.username||s.id;L(s.id);try{l[s.id]??s.isFollowing?(await k.unfollowUser(m),N(h=>({...h,[s.id]:!1})),$.success(`Unfollowed ${s.name}`)):(await k.followUser(m),N(h=>({...h,[s.id]:!0})),$.success(`Now following ${s.name}`))}catch{$.error("Failed to update follow status")}finally{L(null)}},T=()=>{const s=p+1;u(s),E(s)};return n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50",onClick:i}),e.jsxs("div",{className:`fixed inset-x-4 top-1/2 -translate-y-1/2 max-w-lg mx-auto z-50 rounded-2xl shadow-2xl overflow-hidden
        ${t?"bg-slate-900":"bg-white"}`,children:[e.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${t?"border-slate-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-bold ${t?"text-white":"text-gray-900"}`,children:c==="followers"?"Followers":"Following"}),e.jsx("button",{onClick:i,className:`p-2 rounded-full ${t?"hover:bg-slate-800 text-slate-400":"hover:bg-gray-100 text-gray-600"}`,children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:a&&g.length===0?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin"})}):g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:`w-12 h-12 mx-auto mb-3 ${t?"text-slate-600":"text-gray-300"}`}),e.jsx("p",{className:t?"text-slate-400":"text-gray-500",children:c==="followers"?"No followers yet":"Not following anyone yet"})]}):e.jsxs("div",{className:"space-y-3",children:[g.map(s=>{const m=l[s.id]??s.isFollowing;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl ${t?"hover:bg-slate-800":"hover:bg-gray-50"}`,children:[e.jsx(U,{to:`/profile/${s.username||s.id}`,onClick:i,className:"flex-shrink-0",children:s.avatar?e.jsx("img",{src:s.avatar,alt:s.name,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:s.name.charAt(0)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(U,{to:`/profile/${s.username||s.id}`,onClick:i,className:`font-medium hover:underline truncate block ${t?"text-white":"text-gray-900"}`,children:s.name}),s.headline&&e.jsx("p",{className:`text-sm truncate ${t?"text-slate-400":"text-gray-500"}`,children:s.headline})]}),!b||s.id!==x?e.jsx("button",{onClick:()=>R(s),disabled:A===s.id,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${m?t?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-500 text-white hover:bg-blue-600"} disabled:opacity-50`,children:A===s.id?e.jsx(D,{className:"w-4 h-4 animate-spin"}):m?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4"})," Following"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4"})," Follow"]})}):null]},s.id)}),j&&!a&&e.jsx("button",{onClick:T,className:`w-full py-3 text-sm font-medium rounded-xl transition-colors ${t?"text-blue-400 hover:bg-slate-800":"text-blue-600 hover:bg-gray-50"}`,children:"Load more"}),a&&g.length>0&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})})]})})]})]}):null}function W({limit:n=5,className:i=""}){const[x,d]=r.useState([]),[c,b]=r.useState(!0),[P,t]=r.useState("");r.useEffect(()=>{g()},[n]);const g=async()=>{var a,o,p,u,j,f;b(!0);try{let l=await S.getPersonalizedPosts(n);((o=(a=l.data)==null?void 0:a.items)==null?void 0:o.length)>0?(d(l.data.items),t(l.data.algorithm)):(l=await S.getTrendingPosts(n,7),((u=(p=l.data)==null?void 0:p.items)==null?void 0:u.length)>0?(d(l.data.items),t("trending")):(l=await S.getPopularPosts(n),d(((j=l.data)==null?void 0:j.items)||[]),t("popular")))}catch(l){console.error("Error loading recommendations:",l);try{const N=await S.getTrendingPosts(n,7);d(((f=N.data)==null?void 0:f.items)||[]),t("trending")}catch{d([])}}finally{b(!1)}};if(c)return e.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-xl rounded-2xl p-5 border border-slate-700/30 ${i}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-700 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-5 w-32 bg-slate-700 rounded animate-pulse"})]}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((a,o)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-700 rounded-lg animate-pulse flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-700 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-2/3 bg-slate-700 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-1/2 bg-slate-700 rounded animate-pulse"})]})]},o))})]});if(x.length===0)return null;const w=()=>{switch(P){case"personalized":return"For You";case"trending":return"Trending";case"popular":return"Popular";default:return"Recommended"}};return e.jsxs("div",{className:`bg-slate-800/50 backdrop-blur-xl rounded-2xl p-5 border border-slate-700/30 hover:border-slate-600/50 transition-colors ${i}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-amber-500 rounded-lg flex items-center justify-center",children:e.jsx(C,{className:"w-4 h-4 text-white"})}),"Recommended Articles"]}),e.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3"}),w()]})]}),e.jsx("div",{className:"space-y-4",children:x.map(a=>{var o;return e.jsxs(U,{to:`/blog/${a.slug}`,className:"group flex gap-3 p-2 -mx-2 rounded-xl hover:bg-slate-700/50 transition-colors",children:[e.jsx("div",{className:"w-16 h-16 flex-shrink-0 rounded-lg overflow-hidden bg-slate-700",children:a.image?e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-indigo-500/20 to-purple-500/20",children:e.jsx(C,{className:"w-6 h-6 text-slate-500"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white line-clamp-2 group-hover:text-indigo-400 transition-colors",children:a.title}),((o=a.metadata)==null?void 0:o.author)&&e.jsxs("p",{className:"text-xs text-slate-400 mt-1 flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),a.metadata.author]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity self-center",children:e.jsx(G,{className:"w-4 h-4 text-slate-400"})})]},a.id)})})]})}export{V as F,W as R};
