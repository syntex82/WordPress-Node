import{a as q,r,j as e}from"./vendor-react-D2QycniR.js";import{z as m,aI as w,N as I,aJ as A,aK as y,a as n,aL as F,aM as M,v as C,V as k,ah as V}from"./index-Bpp1ZX0C.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";function K(){const u=q(),x=r.useRef(null),[z,p]=r.useState(!1),[d,j]=r.useState(null),[T,g]=r.useState(!1),[f,b]=r.useState(!1),[N,o]=r.useState(0),[t,c]=r.useState(null),h=r.useCallback(s=>{s.preventDefault(),s.stopPropagation(),p(s.type==="dragenter"||s.type==="dragover")},[]),S=r.useCallback(s=>{var l;s.preventDefault(),s.stopPropagation(),p(!1),(l=s.dataTransfer.files)!=null&&l[0]&&v(s.dataTransfer.files[0])},[]),v=async s=>{var l;if(c(null),o(0),!s.name.endsWith(".zip")){m.error("Please select a ZIP file");return}if(s.size>10*1024*1024){m.error("File size exceeds 10MB limit");return}j(s),g(!0);try{const a=await w.validate(s);c(a.data)}catch(a){const i=(l=a.response)==null?void 0:l.data;c(i!=null&&i.errors?{valid:!1,errors:i.errors,warnings:i.warnings||[]}:null),i!=null&&i.errors||m.error("Failed to validate theme")}finally{g(!1)}},B=async()=>{var s;if(!(!d||!(t!=null&&t.valid))){b(!0);try{await w.upload(d,o),m.success("Theme uploaded successfully!"),u("/settings")}catch(l){const a=(s=l.response)==null?void 0:s.data;a!=null&&a.errors?c({valid:!1,errors:a.errors,warnings:a.warnings||[]}):m.error((a==null?void 0:a.message)||"Failed to upload theme")}finally{b(!1)}}},P=()=>{j(null),c(null),o(0),x.current&&(x.current.value="")},U=s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/(1024*1024)).toFixed(2)+" MB";return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>u("/settings"),className:"flex items-center text-slate-400 hover:text-white mb-4 transition-colors",children:[e.jsx(I,{className:"mr-2"})," Back to Settings"]}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent",children:"Theme Builder"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Upload and install custom theme packages"})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-6 mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(A,{className:"mr-2 text-blue-400"})," Theme Structure Requirements"]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4 font-mono text-sm border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center text-slate-300",children:[e.jsx(y,{className:"mr-2 text-yellow-400"})," your-theme-name/"]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-green-400"})," theme.json ",e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(required)"})]}),e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-slate-500"})," screenshot.png ",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(optional)"})]}),e.jsxs("div",{className:"flex items-center text-slate-300",children:[e.jsx(y,{className:"mr-2 text-yellow-400"})," templates/ ",e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(required)"})]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-blue-400"})," home.hbs ",e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(required)"})]}),e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-blue-400"})," single-post.hbs ",e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(required)"})]}),e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-blue-400"})," single-page.hbs ",e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(required)"})]}),e.jsxs("div",{className:"flex items-center text-slate-400",children:[e.jsx(n,{className:"mr-2 text-slate-500"})," archive.hbs ",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(optional)"})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(F,{className:"mr-2"})," Upload Theme Package"]}),e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-colors ${z?"border-blue-500 bg-blue-500/10":"border-slate-600/50 hover:border-slate-500"}`,onDragEnter:h,onDragLeave:h,onDragOver:h,onDrop:S,children:[e.jsx("input",{ref:x,type:"file",accept:".zip",onChange:s=>{var l;return((l=s.target.files)==null?void 0:l[0])&&v(s.target.files[0])},className:"hidden"}),d?e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"text-2xl text-blue-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:d.name}),e.jsx("p",{className:"text-sm text-slate-400",children:U(d.size)})]})]}),e.jsx("button",{onClick:P,className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:e.jsx(C,{size:20})})]}),T&&e.jsxs("div",{className:"flex items-center text-blue-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-400 mr-3"}),"Validating theme structure..."]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`flex items-center p-3 rounded-xl ${t.valid?"bg-green-500/10 text-green-400 border border-green-500/30":"bg-red-500/10 text-red-400 border border-red-500/30"}`,children:t.valid?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"mr-2",size:20}),e.jsx("span",{className:"font-medium",children:"Theme is valid and ready to install"})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mr-2",size:20}),e.jsx("span",{className:"font-medium",children:"Theme validation failed"})]})}),t.themeConfig&&e.jsxs("div",{className:"bg-slate-700/50 p-4 rounded-xl border border-slate-600/50",children:[e.jsx("h3",{className:"font-semibold text-white",children:t.themeConfig.name}),e.jsxs("p",{className:"text-sm text-slate-400",children:["Version ",t.themeConfig.version," by ",t.themeConfig.author]}),t.themeConfig.description&&e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:t.themeConfig.description})]}),t.errors.length>0&&e.jsxs("div",{className:"bg-red-500/10 p-4 rounded-xl border border-red-500/30",children:[e.jsx("h4",{className:"font-medium text-red-400 mb-2",children:"Errors"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-red-300 space-y-1",children:t.errors.map((s,l)=>e.jsx("li",{children:s},l))})]}),t.warnings.length>0&&e.jsxs("div",{className:"bg-yellow-500/10 p-4 rounded-xl border border-yellow-500/30",children:[e.jsxs("h4",{className:"font-medium text-yellow-400 mb-2 flex items-center",children:[e.jsx(V,{className:"mr-2"}),"Warnings"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-300 space-y-1",children:t.warnings.map((s,l)=>e.jsx("li",{children:s},l))})]}),f&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-400 mb-1",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[N,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${N}%`}})})]}),t.valid&&!f&&e.jsxs("button",{onClick:B,className:"w-full py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 font-medium flex items-center justify-center shadow-lg shadow-green-500/20 transition-all",children:[e.jsx(k,{className:"mr-2"})," Install Theme"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mx-auto text-5xl text-slate-500 mb-4"}),e.jsx("p",{className:"text-lg text-slate-300 mb-2",children:"Drag and drop your theme ZIP file here"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"or"}),e.jsx("button",{onClick:()=>{var s;return(s=x.current)==null?void 0:s.click()},className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 shadow-lg shadow-blue-500/20 transition-all",children:"Browse Files"}),e.jsx("p",{className:"text-xs text-slate-500 mt-4",children:"Maximum file size: 10MB"})]})]})]})]})}export{K as default};
