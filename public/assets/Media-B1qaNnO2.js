import{r as a,j as e}from"./vendor-react-D2QycniR.js";import{X as Me,a as Ce,Y as me,Z as J,f as Z,V as De,U as Fe,v as xe,_ as Ie,$ as Pe,a0 as Te,C as ke,a1 as Ae,a2 as Ee,a3 as Le,a4 as Ue,A as Re,a5 as Oe,a6 as We,a7 as Be,a8 as qe,a9 as Ve,M as _e,I as ze,x as Ge,aa as Ye,ab as G,z,T as be,c as He,ac as Ne,e as Ke,ad as we,ae as Qe,b as Xe,y as Ze,af as Je}from"./index-Bwazbld5.js";import{L as et}from"./LoadingSpinner-BUnjBwPP.js";import{C as tt}from"./ConfirmDialog-DoC7ujLB.js";import{u as st,a as je,D as at,c as rt,S as lt,r as it,b as nt,d as ot,s as dt,K as ct,T as ut,P as xt,e as mt,C as ht}from"./sortable.esm-D0ycpRxo.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";const $e={all:"*/*",image:"image/jpeg,image/png,image/gif,image/webp,image/svg+xml",audio:"audio/mpeg,audio/mp3,audio/wav,audio/ogg,audio/aac,audio/flac",video:"video/mp4,video/webm,video/ogg,video/quicktime",document:"application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain"},gt={image:Z,audio:J,video:me,document:Ce,all:Me};function pt({accept:t="all",multiple:j=!0,maxFileSize:h=50,maxFiles:$=20,onFilesSelected:O,onUploadComplete:V,className:S="",compact:M=!1,disabled:f=!1}){const[o,u]=a.useState(!1),[C,v]=a.useState([]),[W,b]=a.useState(0),m=a.useRef(null),x=a.useCallback(l=>l.size>h*1024*1024?{valid:!1,error:`File exceeds ${h}MB limit`}:t!=="all"&&!$e[t].split(",").some(D=>{const F=D.split("*").join(".*");try{return new RegExp(`^${F}$`).test(l.type)}catch{return!1}})?{valid:!1,error:`Invalid file type for ${t}`}:{valid:!0},[t,h]),P=a.useCallback(l=>{const c=Array.from(l).slice(0,$),D=[],F=[];c.forEach(I=>{const U=x(I),se={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,file:I,progress:0,status:U.valid?"pending":"error",error:U.error,preview:I.type.startsWith("image/")?URL.createObjectURL(I):void 0};F.push(se),U.valid&&D.push(I)}),v(I=>[...I,...F]),D.length>0&&O(D)},[$,x,O]),g=a.useCallback(l=>{l.preventDefault(),l.stopPropagation(),b(c=>c+1),l.dataTransfer.items&&l.dataTransfer.items.length>0&&u(!0)},[]),A=a.useCallback(l=>{l.preventDefault(),l.stopPropagation(),b(c=>{const D=c-1;return D===0&&u(!1),D})},[]),y=a.useCallback(l=>{l.preventDefault(),l.stopPropagation()},[]),B=a.useCallback(l=>{if(l.preventDefault(),l.stopPropagation(),u(!1),b(0),f)return;const{files:c}=l.dataTransfer;c&&c.length>0&&P(c)},[f,P]),N=a.useCallback(l=>{const{files:c}=l.target;c&&c.length>0&&P(c),m.current&&(m.current.value="")},[P]),R=()=>{var l;f||(l=m.current)==null||l.click()},p=l=>{v(c=>c.filter(D=>D.id!==l))},ee=()=>{C.forEach(l=>l.preview&&URL.revokeObjectURL(l.preview)),v([])},n=gt[t];return e.jsxs("div",{className:`relative ${S}`,children:[e.jsx("input",{ref:m,type:"file",accept:$e[t],multiple:j,onChange:N,className:"hidden",disabled:f,"aria-label":`Upload ${t} files`}),e.jsxs("div",{onClick:R,onDragEnter:g,onDragLeave:A,onDragOver:y,onDrop:B,role:"button",tabIndex:0,onKeyDown:l=>l.key==="Enter"&&R(),"aria-label":`Drag and drop ${t} files here or click to browse`,className:`
          relative overflow-hidden cursor-pointer transition-all duration-300 ease-out
          border-2 border-dashed rounded-2xl
          ${M?"p-4":"p-8 md:p-12"}
          ${f?"opacity-50 cursor-not-allowed":""}
          ${o?"border-blue-500 bg-blue-500/10 scale-[1.02] shadow-lg shadow-blue-500/20":"border-slate-600 hover:border-slate-500 bg-slate-800/50 hover:bg-slate-800/70"}
        `,children:[o&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-500/20 animate-pulse"}),e.jsxs("div",{className:`relative z-10 text-center ${M?"space-y-2":"space-y-4"}`,children:[e.jsx("div",{className:`
            inline-flex items-center justify-center rounded-full transition-all duration-300
            ${M?"w-12 h-12":"w-16 h-16 md:w-20 md:h-20"}
            ${o?"bg-blue-500 scale-110 rotate-12":"bg-slate-700 group-hover:bg-slate-600"}
          `,children:e.jsx(n,{className:`transition-all duration-300 ${o?"text-white":"text-blue-400"}`,size:M?24:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold text-white transition-colors ${M?"text-base":"text-lg md:text-xl"}`,children:o?"Drop files here!":"Drag & drop files"}),!M&&e.jsxs("p",{className:"text-slate-400 text-sm md:text-base mt-1",children:["or ",e.jsx("span",{className:"text-blue-400 hover:text-blue-300 underline",children:"browse"})," to upload"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 text-xs text-slate-500",children:[e.jsx("span",{className:"px-2 py-1 bg-slate-700/50 rounded-full",children:t==="all"?"All file types":t.charAt(0).toUpperCase()+t.slice(1)}),e.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 rounded-full",children:["Max ",h,"MB"]}),j&&e.jsxs("span",{className:"px-2 py-1 bg-slate-700/50 rounded-full",children:["Up to ",$," files"]})]})]})]}),C.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[C.length," file(s) in queue"]}),e.jsx("button",{onClick:ee,className:"text-xs text-slate-500 hover:text-red-400 transition-colors",children:"Clear all"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2 pr-2 scrollbar-thin scrollbar-thumb-slate-600",children:C.map(l=>e.jsxs("div",{className:`
                  flex items-center gap-3 p-3 rounded-xl transition-all
                  ${l.status==="error"?"bg-red-500/10 border border-red-500/30":"bg-slate-800/50"}
                `,children:[l.preview?e.jsx("img",{src:l.preview,alt:"",className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-700 flex items-center justify-center",children:e.jsx(Ce,{className:"text-slate-400",size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-white truncate",children:l.file.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[(l.file.size/1024/1024).toFixed(2)," MB",l.error&&e.jsx("span",{className:"text-red-400 ml-2",children:l.error})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.status==="success"&&e.jsx(De,{className:"text-green-400",size:18}),l.status==="error"&&e.jsx(Fe,{className:"text-red-400",size:18}),l.status==="uploading"&&e.jsx("div",{className:"w-5 h-5 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),e.jsx("button",{onClick:()=>p(l.id),className:"p-1 text-slate-500 hover:text-red-400 transition-colors","aria-label":"Remove file",children:e.jsx(xe,{size:16})})]})]},l.id))})]})]})}const ve=t=>{if(isNaN(t))return"0:00";const j=Math.floor(t/60),h=Math.floor(t%60);return`${j}:${h.toString().padStart(2,"0")}`},ft={modern:{bg:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",surface:"bg-slate-800/60",accent:"from-blue-500 to-purple-500",accentSolid:"bg-blue-500",text:"text-white",textMuted:"text-slate-400",border:"border-slate-700/50"},minimal:{bg:"bg-white dark:bg-slate-900",surface:"bg-slate-100 dark:bg-slate-800",accent:"from-slate-700 to-slate-900",accentSolid:"bg-slate-800 dark:bg-white",text:"text-slate-900 dark:text-white",textMuted:"text-slate-500 dark:text-slate-400",border:"border-slate-200 dark:border-slate-700"},retro:{bg:"bg-gradient-to-br from-amber-900 via-orange-900 to-amber-950",surface:"bg-amber-800/40",accent:"from-orange-400 to-amber-500",accentSolid:"bg-orange-500",text:"text-amber-50",textMuted:"text-amber-300/70",border:"border-amber-700/50"},glassmorphic:{bg:"bg-white/10 backdrop-blur-xl",surface:"bg-white/5 backdrop-blur-md",accent:"from-pink-500 to-violet-500",accentSolid:"bg-pink-500",text:"text-white",textMuted:"text-white/60",border:"border-white/20"},neon:{bg:"bg-black",surface:"bg-slate-900",accent:"from-cyan-400 to-fuchsia-500",accentSolid:"bg-cyan-400",text:"text-white",textMuted:"text-cyan-300/70",border:"border-cyan-500/30"}};function bt({tracks:t,initialTrackIndex:j=0,skin:h="modern",autoPlay:$=!1,showPlaylist:O=!0,showVisualization:V=!0,showVinylAnimation:S=!0,onTrackChange:M,onPlayStateChange:f,className:o=""}){const u=a.useRef(null),C=a.useRef(null),v=a.useRef(),W=a.useRef(null),b=a.useRef(null),m=a.useRef(!1),[x,P]=a.useState(j),[g,A]=a.useState(!1),[y,B]=a.useState(0),[N,R]=a.useState(0),[p,ee]=a.useState(.7),[n,l]=a.useState(!1),[c,D]=a.useState(!1),[F,I]=a.useState("none"),[U,se]=a.useState(O),[ie,ye]=a.useState(!1),[Y,H]=a.useState(!1),[ne,te]=a.useState(null),k=a.useMemo(()=>t[x]||t[0],[t,x]),d=ft[h],[E,he]=a.useState([]);a.useEffect(()=>{if(c){const r=t.map((i,L)=>L).sort(()=>Math.random()-.5);he(r)}},[c,t.length]);const oe=a.useCallback(()=>{if(!(!u.current||m.current))try{const r=new(window.AudioContext||window.webkitAudioContext),i=r.createAnalyser(),L=r.createMediaElementSource(u.current);i.fftSize=256,i.smoothingTimeConstant=.8,L.connect(i),i.connect(r.destination),W.current=r,b.current=i,m.current=!0}catch(r){console.warn("Failed to initialize audio context:",r)}},[]),de=a.useCallback(()=>{if(!C.current||!b.current)return;const r=C.current,i=r.getContext("2d");if(!i)return;const L=b.current.frequencyBinCount,Q=new Uint8Array(L),ae=()=>{if(!g)return;v.current=requestAnimationFrame(ae),b.current.getByteFrequencyData(Q),i.clearRect(0,0,r.width,r.height);const re=r.width/L*2.5;let le=0;for(let pe=0;pe<L;pe++){const fe=Q[pe]/255*r.height*.9,X=i.createLinearGradient(0,r.height,0,r.height-fe);h==="neon"?(X.addColorStop(0,"#22d3ee"),X.addColorStop(.5,"#a855f7"),X.addColorStop(1,"#ec4899")):h==="retro"?(X.addColorStop(0,"#f97316"),X.addColorStop(1,"#fbbf24")):(X.addColorStop(0,"#3b82f6"),X.addColorStop(1,"#8b5cf6")),i.fillStyle=X,i.fillRect(le,r.height-fe,re-1,fe),le+=re+1}};ae()},[g,h]),ce=a.useCallback(async()=>{if(u.current)try{W.current||oe(),g?(u.current.pause(),v.current&&cancelAnimationFrame(v.current)):(H(!0),await u.current.play(),de()),A(!g),f==null||f(!g)}catch(r){te("Failed to play audio"),console.error("Playback error:",r)}finally{H(!1)}},[g,oe,de,f]),_=a.useCallback(r=>{r<0||r>=t.length||(P(r),B(0),M==null||M(t[r],r))},[t,M]),q=a.useCallback(()=>{if(c&&E.length>0){const i=(E.indexOf(x)+1)%E.length;_(E[i])}else{const r=(x+1)%t.length;_(r)}},[x,c,E,t.length,_]),ge=a.useCallback(()=>{if(y>3){u.current&&(u.current.currentTime=0);return}if(c&&E.length>0){const i=(E.indexOf(x)-1+E.length)%E.length;_(E[i])}else{const r=(x-1+t.length)%t.length;_(r)}},[y,x,c,E,t.length,_]),ue=a.useCallback(r=>{const i=parseFloat(r.target.value);ee(i),u.current&&(u.current.volume=i),i>0&&l(!1)},[]),s=a.useCallback(()=>{u.current&&(u.current.muted=!n,l(!n))},[n]),w=a.useCallback(r=>{const i=parseFloat(r.target.value);B(i),u.current&&(u.current.currentTime=i)},[]),T=a.useCallback(()=>{I(r=>r==="none"?"all":r==="all"?"one":"none")},[]);a.useEffect(()=>{const r=u.current;if(!r)return;const i=()=>B(r.currentTime),L=()=>{R(r.duration),H(!1)},Q=()=>{F==="one"?(r.currentTime=0,r.play()):F==="all"||x<t.length-1?q():(A(!1),f==null||f(!1))},ae=()=>te("Failed to load audio"),re=()=>H(!0),le=()=>H(!1);return r.addEventListener("timeupdate",i),r.addEventListener("loadedmetadata",L),r.addEventListener("ended",Q),r.addEventListener("error",ae),r.addEventListener("waiting",re),r.addEventListener("canplay",le),()=>{r.removeEventListener("timeupdate",i),r.removeEventListener("loadedmetadata",L),r.removeEventListener("ended",Q),r.removeEventListener("error",ae),r.removeEventListener("waiting",re),r.removeEventListener("canplay",le)}},[F,x,t.length,q,f]),a.useEffect(()=>{u.current&&g&&u.current.play().catch(console.error)},[x]),a.useEffect(()=>()=>{v.current&&cancelAnimationFrame(v.current)},[]);const K=N>0?y/N*100:0;return e.jsxs("div",{className:`${d.bg} ${d.border} border rounded-2xl overflow-hidden ${o}`,children:[e.jsx("div",{className:"p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6",children:[e.jsxs("div",{className:"relative flex-shrink-0 mx-auto md:mx-0",children:[e.jsxs("div",{className:`
              relative w-32 h-32 md:w-40 md:h-40 rounded-xl overflow-hidden
              ${S&&g?"animate-spin-slow":""}
              shadow-2xl
            `,children:[k.coverImage?e.jsx("img",{src:k.coverImage,alt:k.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:`w-full h-full bg-gradient-to-br ${d.accent} flex items-center justify-center`,children:e.jsx(J,{className:"text-white/80",size:48})}),S&&e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx("div",{className:`
                    absolute inset-2 rounded-full border-4 border-black/20
                    ${g?"animate-pulse":""}
                  `,children:e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-transparent via-white/5 to-transparent"})})})]}),V&&g&&e.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 flex items-end gap-0.5 h-6",children:[...Array(5)].map((r,i)=>e.jsx("div",{className:`w-1 ${d.accentSolid} rounded-full animate-equalizer`,style:{height:`${Math.random()*100}%`,animationDelay:`${i*.1}s`}},i))})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center text-center md:text-left",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:`text-lg md:text-xl font-bold ${d.text} truncate`,children:k.title}),e.jsxs("p",{className:`${d.textMuted} text-sm truncate`,children:[k.artist,k.album&&e.jsxs("span",{children:[" • ",k.album]})]})]}),V&&e.jsxs("div",{className:"relative h-12 mb-4 rounded-lg overflow-hidden bg-black/20",children:[e.jsx("canvas",{ref:C,width:400,height:48,className:"w-full h-full"}),!g&&e.jsx("div",{className:"absolute inset-0 flex items-end justify-around px-2",children:[...Array(30)].map((r,i)=>e.jsx("div",{className:`w-1 ${d.accentSolid} rounded-full opacity-40`,style:{height:`${20+Math.random()*60}%`}},i))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"range",min:0,max:N||100,value:y,onChange:w,className:"w-full h-2 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, var(--tw-gradient-from) ${K}%, rgba(255,255,255,0.1) ${K}%)`,"--tw-gradient-from":h==="neon"?"#22d3ee":h==="retro"?"#f97316":"#3b82f6"},"aria-label":"Seek audio"}),e.jsxs("div",{className:`flex justify-between mt-1 text-xs ${d.textMuted}`,children:[e.jsx("span",{children:ve(y)}),e.jsx("span",{children:ve(N)})]})]}),e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2 md:gap-4",children:[e.jsx("button",{onClick:()=>D(!c),className:`p-2 rounded-full transition-all ${c?d.accentSolid+" text-white":d.textMuted+" hover:"+d.text}`,"aria-label":"Toggle shuffle",children:e.jsx(Ie,{size:18})}),e.jsx("button",{onClick:ge,className:`p-2 rounded-full transition-all ${d.textMuted} hover:${d.text}`,"aria-label":"Previous track",children:e.jsx(Pe,{size:24})}),e.jsx("button",{onClick:ce,className:`
                  w-14 h-14 rounded-full flex items-center justify-center
                  bg-gradient-to-r ${d.accent} text-white
                  shadow-lg hover:scale-105 transition-all
                  ${Y?"animate-pulse":""}
                `,disabled:Y,"aria-label":g?"Pause":"Play",children:Y?e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):g?e.jsx(Te,{size:24}):e.jsx(ke,{size:24,className:"ml-1"})}),e.jsx("button",{onClick:q,className:`p-2 rounded-full transition-all ${d.textMuted} hover:${d.text}`,"aria-label":"Next track",children:e.jsx(Ae,{size:24})}),e.jsxs("button",{onClick:T,className:`p-2 rounded-full transition-all relative ${F!=="none"?d.accentSolid+" text-white":d.textMuted+" hover:"+d.text}`,"aria-label":"Toggle repeat",children:[e.jsx(Ee,{size:18}),F==="one"&&e.jsx("span",{className:"absolute -top-1 -right-1 text-[10px] bg-white text-black w-4 h-4 rounded-full flex items-center justify-center font-bold",children:"1"})]})]})]}),e.jsxs("div",{className:"hidden md:flex flex-col items-center gap-2",children:[e.jsx("button",{onClick:s,className:`p-2 rounded-full transition-all ${d.textMuted} hover:${d.text}`,"aria-label":n?"Unmute":"Mute",children:n||p===0?e.jsx(Le,{size:20}):e.jsx(Ue,{size:20})}),e.jsx("input",{type:"range",min:0,max:1,step:.01,value:n?0:p,onChange:ue,className:"w-20 h-1.5 rounded-full appearance-none cursor-pointer rotate-0",style:{background:`linear-gradient(to right, var(--tw-gradient-from) ${p*100}%, rgba(255,255,255,0.1) ${p*100}%)`,"--tw-gradient-from":h==="neon"?"#22d3ee":h==="retro"?"#f97316":"#3b82f6"},"aria-label":"Volume"})]})]})}),t.length>1&&e.jsxs("div",{className:`border-t ${d.border}`,children:[e.jsxs("button",{onClick:()=>se(!U),className:`w-full flex items-center justify-between px-4 py-3 ${d.surface} ${d.text} hover:opacity-80 transition-all`,"aria-expanded":U,"aria-label":"Toggle playlist",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{size:18}),e.jsxs("span",{className:"text-sm font-medium",children:["Playlist (",t.length," tracks)"]})]}),U?e.jsx(Oe,{size:18}):e.jsx(We,{size:18})]}),U&&e.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.map((r,i)=>e.jsxs("button",{onClick:()=>_(i),className:`
                    w-full flex items-center gap-3 px-4 py-3 transition-all
                    ${i===x?`${d.surface} border-l-2 border-l-blue-500`:`hover:${d.surface}`}
                  `,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${i===x?`bg-gradient-to-r ${d.accent}`:d.surface}`,children:i===x&&g?e.jsx("div",{className:"flex items-end gap-0.5 h-4",children:[...Array(3)].map((L,Q)=>e.jsx("div",{className:"w-0.5 bg-white rounded-full animate-equalizer",style:{height:"100%",animationDelay:`${Q*.15}s`}},Q))}):e.jsx("span",{className:`text-xs ${d.textMuted}`,children:i+1})}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("p",{className:`text-sm font-medium ${d.text} truncate`,children:r.title}),e.jsx("p",{className:`text-xs ${d.textMuted} truncate`,children:r.artist})]}),e.jsx("span",{className:`text-xs ${d.textMuted}`,children:r.duration?ve(r.duration):"--:--"})]},r.id))})]}),ne&&e.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-400 text-sm text-center",children:ne}),e.jsx("audio",{ref:u,src:k.src,preload:"metadata",crossOrigin:"anonymous"}),e.jsx("style",{children:`
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
          animation: spin-slow 3s linear infinite;
        }
        @keyframes equalizer {
          0%, 100% { transform: scaleY(0.3); }
          50% { transform: scaleY(1); }
        }
        .animate-equalizer {
          animation: equalizer 0.5s ease-in-out infinite;
          transform-origin: bottom;
        }
        input[type="range"]::-webkit-slider-thumb {
          -webkit-appearance: none;
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: white;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        input[type="range"]::-moz-range-thumb {
          width: 14px;
          height: 14px;
          border-radius: 50%;
          background: white;
          cursor: pointer;
          border: none;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
      `})]})}const jt={image:Z,video:me,audio:J};function vt({item:t,isSelected:j,isDragging:h,aspectRatio:$,showActions:O,onSelect:V,onDelete:S,onPreview:M}){const{attributes:f,listeners:o,setNodeRef:u,transform:C,transition:v}=mt({id:t.id}),[W,b]=a.useState(!1),[m,x]=a.useState(!1),P={transform:ht.Transform.toString(C),transition:v},g=$==="square"?"aspect-square":$==="video"?"aspect-video":"",A=jt[t.type];return e.jsxs("div",{ref:u,style:P,className:`
        group relative rounded-xl overflow-hidden transition-all duration-200
        ${h?"opacity-50 scale-95":""}
        ${j?"ring-2 ring-blue-500 ring-offset-2 ring-offset-slate-900":""}
        ${W?"shadow-xl shadow-black/30 z-10":"shadow-lg shadow-black/20"}
      `,onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),onClick:V,children:[e.jsxs("div",{className:`relative bg-slate-800 ${g}`,children:[t.type==="image"&&e.jsx("img",{src:t.thumbnail||t.src,alt:t.title||"Gallery image",className:"w-full h-full object-cover",loading:"lazy"}),t.type==="video"&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:t.thumbnail||"/video-placeholder.jpg",alt:t.title||"Video thumbnail",className:"w-full h-full object-cover",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 rounded-full bg-black/60 flex items-center justify-center backdrop-blur-sm",children:e.jsx(ke,{className:"text-white ml-1",size:24})})})]}),t.type==="audio"&&e.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-purple-600 to-blue-600 flex flex-col items-center justify-center p-4",children:[e.jsx(J,{className:"text-white/80 mb-2",size:32}),e.jsx("p",{className:"text-white text-sm font-medium text-center truncate w-full",children:t.title||"Audio"}),t.duration&&e.jsxs("p",{className:"text-white/60 text-xs mt-1",children:[Math.floor(t.duration/60),":",String(Math.floor(t.duration%60)).padStart(2,"0")]})]}),e.jsx("div",{className:"absolute top-2 left-2 p-1.5 rounded-lg bg-black/50 backdrop-blur-sm",children:e.jsx(A,{className:"text-white",size:14})}),j&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),O&&e.jsxs("div",{className:`
            absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent
            flex items-end justify-between p-3 transition-opacity duration-200
            ${W?"opacity-100":"opacity-0"}
          `,children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{...f,...o,className:"p-2 rounded-lg bg-white/20 hover:bg-white/30 text-white cursor-grab active:cursor-grabbing touch-manipulation","aria-label":"Drag to reorder",children:e.jsx(Ve,{size:16})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),M()},className:"p-2 rounded-lg bg-white/20 hover:bg-white/30 text-white","aria-label":"Preview",children:e.jsx(_e,{size:16})})]}),S&&e.jsx("button",{onClick:y=>{y.stopPropagation(),S()},className:"p-2 rounded-lg bg-red-500/80 hover:bg-red-500 text-white","aria-label":"Delete",children:e.jsx(ze,{size:16})})]})]}),t.title&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent",children:e.jsx("p",{className:"text-white text-sm font-medium truncate",children:t.title})})]})}function yt({items:t,onReorder:j,onDelete:h,onSelect:$,selectable:O=!1,selectedIds:V=new Set,columns:S={sm:2,md:3,lg:4,xl:5},aspectRatio:M="square",gap:f=4,showActions:o=!0,draggable:u=!0,className:C=""}){const[v,W]=a.useState(null),[b,m]=a.useState(null),[x,P]=a.useState(0),g=st(je(xt,{activationConstraint:{distance:8}}),je(ut,{activationConstraint:{delay:200,tolerance:5}}),je(ct,{coordinateGetter:dt})),A=n=>{W(n.active.id)},y=n=>{const{active:l,over:c}=n;if(W(null),c&&l.id!==c.id&&j){const D=t.findIndex(I=>I.id===l.id),F=t.findIndex(I=>I.id===c.id);j(ot(t,D,F))}},B=(n,l)=>{m(n),P(l)},N=()=>{x>0&&(P(x-1),m(t[x-1]))},R=()=>{x<t.length-1&&(P(x+1),m(t[x+1]))},p=v?t.find(n=>n.id===v):null,ee=`grid-cols-${S.sm} md:grid-cols-${S.md} lg:grid-cols-${S.lg} xl:grid-cols-${S.xl}`;return t.length===0?e.jsxs("div",{className:`text-center py-12 ${C}`,children:[e.jsx(Z,{className:"mx-auto text-slate-600 mb-4",size:48}),e.jsx("p",{className:"text-slate-400 mb-2",children:"No media items"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Upload media to see it here"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:C,children:e.jsxs(at,{sensors:g,collisionDetection:rt,onDragStart:A,onDragEnd:y,children:[e.jsx(lt,{items:t.map(n=>n.id),strategy:it,children:e.jsx("div",{className:`grid gap-${f} ${ee}`,style:{gridTemplateColumns:`repeat(auto-fill, minmax(min(100%, ${100/S.sm}%), 1fr))`},children:t.map((n,l)=>e.jsx(vt,{item:n,isSelected:V.has(n.id),isDragging:v===n.id,aspectRatio:M,showActions:o,onSelect:()=>$==null?void 0:$(n),onDelete:h?()=>h(n.id):void 0,onPreview:()=>B(n,l)},n.id))})}),e.jsx(nt,{children:p&&e.jsxs("div",{className:"rounded-xl overflow-hidden shadow-2xl ring-2 ring-blue-500 opacity-80",children:[p.type==="image"&&e.jsx("img",{src:p.thumbnail||p.src,alt:"",className:"w-32 h-32 object-cover"}),p.type!=="image"&&e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center",children:p.type==="video"?e.jsx(me,{size:32,className:"text-white"}):e.jsx(J,{size:32,className:"text-white"})})]})})]})}),b&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 flex items-center justify-center",onClick:()=>m(null),children:[e.jsx("button",{className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white",onClick:()=>m(null),"aria-label":"Close preview",children:e.jsx(xe,{size:24})}),x>0&&e.jsx("button",{className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/10 hover:bg-white/20 text-white",onClick:n=>{n.stopPropagation(),N()},"aria-label":"Previous",children:e.jsx(Be,{size:24})}),x<t.length-1&&e.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 rounded-full bg-white/10 hover:bg-white/20 text-white",onClick:n=>{n.stopPropagation(),R()},"aria-label":"Next",children:e.jsx(qe,{size:24})}),e.jsxs("div",{className:"max-w-5xl max-h-[90vh] p-4",onClick:n=>n.stopPropagation(),children:[b.type==="image"&&e.jsx("img",{src:b.src,alt:b.title||"",className:"max-w-full max-h-[80vh] object-contain rounded-lg"}),b.type==="video"&&e.jsx("video",{src:b.src,controls:!0,autoPlay:!0,className:"max-w-full max-h-[80vh] rounded-lg"}),b.type==="audio"&&e.jsxs("div",{className:"bg-slate-800 p-8 rounded-xl text-center",children:[e.jsx(J,{className:"mx-auto text-blue-400 mb-4",size:64}),e.jsx("p",{className:"text-white text-xl font-bold mb-2",children:b.title||"Audio"}),e.jsx("audio",{src:b.src,controls:!0,autoPlay:!0,className:"w-full mt-4"})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-white font-medium",children:b.title}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[x+1," of ",t.length]})]})]})]})]})}const Se={upload:{title:"Upload Files",content:"Click to select files or drag and drop directly onto the page. Supports images, videos, audio, and documents."}};function Dt(){var ue;const t=Ge(),{user:j}=Ye(),h=(j==null?void 0:j.role)==="ADMIN"||(j==null?void 0:j.role)==="SUPER_ADMIN",[$,O]=a.useState([]),[V,S]=a.useState(!0),[M,f]=a.useState(!1),[o,u]=a.useState(null),[C,v]=a.useState({isOpen:!1,mediaId:null}),[W,b]=a.useState(!1),[m,x]=a.useState("all"),[P,g]=a.useState(!1),[A,y]=a.useState({alt:"",caption:""}),B=a.useRef(null),[N,R]=a.useState("my-media"),[p,ee]=a.useState(null),[n,l]=a.useState(null),[c,D]=a.useState(null),[F,I]=a.useState("grid"),[U,se]=a.useState(new Set),[ie,ye]=a.useState(!1),[Y,H]=a.useState(!1),ne=a.useMemo(()=>$.map(s=>({id:s.id,type:s.mimeType.startsWith("image/")?"image":s.mimeType.startsWith("video/")?"video":s.mimeType.startsWith("audio/")?"audio":"image",src:s.path,thumbnail:s.mimeType.startsWith("image/")?s.path:void 0,title:s.originalName,description:s.caption,size:s.size,duration:s.duration})),[$]),te=a.useMemo(()=>$.filter(s=>s.mimeType.startsWith("audio/")).map(s=>({id:s.id,src:s.path,title:s.originalName.replace(/\.[^/.]+$/,""),artist:"Unknown Artist",duration:s.duration})),[$]);a.useEffect(()=>{k(),he(),h&&E()},[h]),a.useEffect(()=>{N==="my-media"?k():N==="all-media"&&d()},[N,n]);const k=async()=>{try{S(!0);const s=await G.getAll();O(s.data.data)}catch{z.error("Failed to load media")}finally{S(!1)}},d=async()=>{try{S(!0);const s={};n&&(s.userId=n);const w=await G.getAllMedia(s);O(w.data.data)}catch{z.error("Failed to load media")}finally{S(!1)}},E=async()=>{try{const s=await G.getAllStorageStats();ee(s.data)}catch{console.error("Failed to load storage stats")}},he=async()=>{try{const s=await G.getMyStorageStats();D(s.data)}catch{console.error("Failed to load storage stats")}},oe=async s=>{if(!s||s.length===0)return;f(!0);const w=Array.from(s).map(T=>G.upload(T));try{await Promise.all(w),z.success(`${s.length} file(s) uploaded successfully`),k()}catch{z.error("Failed to upload some files")}finally{f(!1)}},de=async()=>{if(o)try{z.success("Metadata updated successfully"),g(!1),k(),u({...o,...A})}catch{z.error("Failed to update metadata")}},ce=$.filter(s=>m==="all"?!0:m==="image"?s.mimeType.startsWith("image/"):m==="video"?s.mimeType.startsWith("video/"):m==="audio"?s.mimeType.startsWith("audio/"):m==="document"?!s.mimeType.startsWith("image/")&&!s.mimeType.startsWith("video/")&&!s.mimeType.startsWith("audio/"):!0),_=async s=>{try{await G.delete(s),z.success("Media deleted successfully"),k(),v({isOpen:!1,mediaId:null}),u(null)}catch{z.error("Failed to delete media")}},q=s=>{if(s===0)return"0 Bytes";const w=1024,T=["Bytes","KB","MB","GB"],K=Math.floor(Math.log(s)/Math.log(w));return Math.round(s/Math.pow(w,K)*100)/100+" "+T[K]},ge=async()=>{var s,w;H(!0);try{const T=await G.optimizeAll(),{optimized:K,skipped:r,failed:i,savedBytes:L}=T.data;K>0?(z.success(`Optimized ${K} images! Saved ${q(L)}`),k()):r>0&&i===0?z.success("All images are already optimized!"):i>0?z.error(`${i} images failed to optimize`):z.success("No images need optimization")}catch(T){z.error(((w=(s=T.response)==null?void 0:s.data)==null?void 0:w.message)||"Failed to optimize media")}finally{H(!1)}};return V&&!p?e.jsx(et,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:`text-3xl font-bold ${t.titleGradient}`,children:"Media Library"}),e.jsx(be,{title:"About Media Library",content:"Your personal media library. Upload files here to use them in posts and pages.",position:"right",variant:"help",children:e.jsx("button",{className:`p-1 ${t.icon} hover:text-blue-400`,children:e.jsx(He,{size:18})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[c&&e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg ${t.isDark?"bg-slate-800/50 border border-slate-700/50":"bg-gray-100 border border-gray-200"}`,children:[e.jsx(Ne,{className:"text-blue-400",size:16}),e.jsxs("span",{className:`text-sm ${t.textMuted}`,children:[q(c.totalSize)," • ",c.fileCount," files"]})]}),e.jsx(be,{title:"Optimize All Images",content:"Convert all images to WebP format for faster loading and smaller file sizes.",position:"left",children:e.jsxs("button",{onClick:ge,disabled:Y,className:`flex items-center px-4 py-2 rounded-xl transition-all ${Y?"bg-gray-500 cursor-not-allowed":"bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 shadow-lg shadow-emerald-500/20"} text-white`,children:[e.jsx(Ke,{className:`mr-2 ${Y?"animate-pulse":""}`,size:18}),Y?"Optimizing...":"Optimize All"]})}),e.jsx(be,{title:Se.upload.title,content:Se.upload.content,position:"left",children:e.jsxs("button",{onClick:()=>{var s;return(s=B.current)==null?void 0:s.click()},className:"flex items-center bg-gradient-to-r from-amber-600 to-amber-500 text-white px-4 py-2 rounded-xl hover:from-amber-500 hover:to-amber-400 shadow-lg shadow-amber-500/20 transition-all",children:[e.jsx(Me,{className:"mr-2",size:18}),"Upload Files"]})})]}),e.jsx("input",{ref:B,type:"file",multiple:!0,accept:"image/*,video/*,audio/*",onChange:s=>oe(s.target.files),className:"hidden"})]}),h&&e.jsxs("div",{className:"mb-6 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>{R("my-media"),l(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${N==="my-media"?"bg-gradient-to-r from-indigo-600 to-indigo-500 text-white shadow-lg shadow-indigo-500/20":t.isDark?"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50 hover:text-white":"bg-white text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(we,{size:16}),"My Media"]}),e.jsxs("button",{onClick:()=>{R("all-media"),l(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${N==="all-media"?"bg-gradient-to-r from-indigo-600 to-indigo-500 text-white shadow-lg shadow-indigo-500/20":t.isDark?"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50 hover:text-white":"bg-white text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(Z,{size:16}),"All Media"]}),e.jsxs("button",{onClick:()=>R("storage"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${N==="storage"?"bg-gradient-to-r from-indigo-600 to-indigo-500 text-white shadow-lg shadow-indigo-500/20":t.isDark?"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50 hover:text-white":"bg-white text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(Qe,{size:16}),"Storage Dashboard"]})]}),h&&N==="storage"&&p&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`rounded-xl p-5 ${t.card}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20",children:e.jsx(Ne,{className:"text-blue-400",size:20})}),e.jsx("span",{className:t.textMuted,children:"Total Storage"})]}),e.jsx("p",{className:`text-2xl font-bold ${t.textPrimary}`,children:q(p.totals.totalSize)})]}),e.jsxs("div",{className:`rounded-xl p-5 ${t.card}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/20",children:e.jsx(Z,{className:"text-green-400",size:20})}),e.jsx("span",{className:t.textMuted,children:"Total Files"})]}),e.jsx("p",{className:`text-2xl font-bold ${t.textPrimary}`,children:p.totals.totalFiles.toLocaleString()})]}),e.jsxs("div",{className:`rounded-xl p-5 ${t.card}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20",children:e.jsx(Xe,{className:"text-purple-400",size:20})}),e.jsx("span",{className:t.textMuted,children:"Users with Media"})]}),e.jsx("p",{className:`text-2xl font-bold ${t.textPrimary}`,children:p.totals.totalUsers})]})]}),e.jsxs("div",{className:`rounded-xl border overflow-hidden ${t.card}`,children:[e.jsx("div",{className:`px-4 py-3 border-b ${t.border}`,children:e.jsx("h3",{className:`font-semibold ${t.textPrimary}`,children:"Storage by User"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t.isDark?"bg-slate-800/50":"bg-gray-50",children:[e.jsx("th",{className:`px-4 py-3 text-left text-sm font-medium ${t.textMuted}`,children:"User"}),e.jsx("th",{className:`px-4 py-3 text-left text-sm font-medium ${t.textMuted}`,children:"Role"}),e.jsx("th",{className:`px-4 py-3 text-right text-sm font-medium ${t.textMuted}`,children:"Files"}),e.jsx("th",{className:`px-4 py-3 text-right text-sm font-medium ${t.textMuted}`,children:"Storage Used"}),e.jsx("th",{className:`px-4 py-3 text-right text-sm font-medium ${t.textMuted}`,children:"% of Total"}),e.jsx("th",{className:`px-4 py-3 text-center text-sm font-medium ${t.textMuted}`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t.border}`,children:p.users.map(s=>e.jsxs("tr",{className:`${t.isDark?"hover:bg-slate-800/30":"hover:bg-gray-50"} transition-colors`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.avatar?e.jsx("img",{src:s.avatar,alt:s.name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white text-sm font-medium",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${t.textPrimary}`,children:s.name}),e.jsx("p",{className:`text-xs ${t.textMuted}`,children:s.email})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.role==="ADMIN"?"bg-red-500/20 text-red-400":s.role==="EDITOR"?"bg-blue-500/20 text-blue-400":"bg-gray-500/20 text-gray-400"}`,children:s.role})}),e.jsx("td",{className:`px-4 py-3 text-right ${t.textPrimary}`,children:s.fileCount}),e.jsx("td",{className:`px-4 py-3 text-right font-medium ${t.textPrimary}`,children:q(s.totalSize)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-indigo-500",style:{width:`${Math.min(100,s.totalSize/p.totals.totalSize*100)}%`}})}),e.jsxs("span",{className:`text-sm ${t.textMuted}`,children:[(s.totalSize/p.totals.totalSize*100).toFixed(1),"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>{R("all-media"),l(s.id)},className:"px-3 py-1.5 text-xs bg-indigo-500/20 text-indigo-400 rounded-lg hover:bg-indigo-500/30 transition-colors",children:"View Files"})})]},s.id))})]})})]})]}),N!=="storage"&&e.jsxs(e.Fragment,{children:[h&&N==="all-media"&&n&&p&&e.jsxs("div",{className:`mb-4 flex items-center gap-2 px-4 py-2 rounded-lg ${t.isDark?"bg-indigo-500/10 border border-indigo-500/30":"bg-indigo-50 border border-indigo-200"}`,children:[e.jsx(we,{className:"text-indigo-400",size:16}),e.jsxs("span",{className:t.textPrimary,children:["Viewing media for: ",e.jsx("strong",{children:(ue=p.users.find(s=>s.id===n))==null?void 0:ue.name})]}),e.jsx("button",{onClick:()=>l(null),className:"ml-auto px-2 py-1 text-xs bg-indigo-500/20 text-indigo-400 rounded hover:bg-indigo-500/30 transition-colors",children:"Clear Filter"})]}),e.jsx("div",{className:"mb-6 flex flex-wrap gap-2",children:[{id:"all",label:"All Files"},{id:"image",label:"Images"},{id:"video",label:"Videos"},{id:"audio",label:"Audio"},{id:"document",label:"Documents"}].map(s=>e.jsx("button",{onClick:()=>x(s.id),className:`px-4 py-2 rounded-lg transition-all ${m===s.id?"bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/20":t.isDark?"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:bg-slate-700/50 hover:text-white":"bg-white text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-900"}`,children:s.label},s.id))}),e.jsx("div",{className:"mb-6",children:e.jsx(pt,{accept:m==="all"?"all":m,onFilesSelected:async s=>{f(!0);const w=s.map(T=>G.upload(T));try{await Promise.all(w),z.success(`${s.length} file(s) uploaded successfully`),k()}catch{z.error("Failed to upload some files")}finally{f(!1)}},maxFiles:20,maxFileSize:100,disabled:M})}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:`flex rounded-lg overflow-hidden border ${t.border}`,children:[e.jsxs("button",{onClick:()=>I("grid"),className:`flex items-center gap-2 px-4 py-2 transition-all ${F==="grid"?"bg-gradient-to-r from-blue-600 to-blue-500 text-white":t.isDark?"bg-slate-800 text-slate-400 hover:text-white":"bg-white text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ze,{size:16}),"Grid"]}),e.jsxs("button",{onClick:()=>I("gallery"),className:`flex items-center gap-2 px-4 py-2 transition-all ${F==="gallery"?"bg-gradient-to-r from-blue-600 to-blue-500 text-white":t.isDark?"bg-slate-800 text-slate-400 hover:text-white":"bg-white text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Z,{size:16}),"Gallery"]})]}),te.length>0&&e.jsxs("button",{onClick:()=>ye(!ie),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${ie?"bg-gradient-to-r from-purple-600 to-pink-500 text-white shadow-lg shadow-purple-500/20":t.isDark?"bg-slate-800 text-slate-400 border border-slate-700 hover:text-white":"bg-white text-gray-600 border border-gray-300 hover:text-gray-900"}`,children:[e.jsx(J,{size:16}),"Audio Player (",te.length,")"]}),U.size>0&&e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${t.isDark?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600"}`,children:[e.jsxs("span",{children:[U.size," selected"]}),e.jsx("button",{onClick:()=>se(new Set),className:"hover:text-white transition-colors",children:e.jsx(xe,{size:16})})]})]}),ie&&te.length>0&&e.jsx("div",{className:"mb-6",children:e.jsx(bt,{tracks:te,skin:"modern",showVisualization:!0,showVinylAnimation:!0})}),ce.length===0?e.jsxs("div",{className:`text-center py-12 rounded-xl border ${t.card}`,children:[e.jsx(Z,{className:`mx-auto mb-4 ${t.textMuted}`,size:64}),e.jsx("p",{className:t.textMuted,children:m==="all"?"No media files yet. Upload some files to get started!":`No ${m} files found.`})]}):F==="gallery"?e.jsx(yt,{items:ne.filter(s=>m==="all"?!0:s.type===m),onSelect:s=>{const w=$.find(T=>T.id===s.id);w&&(u(w),y({alt:w.alt||"",caption:w.caption||""}),g(!1))},onDelete:async s=>{if(confirm("Are you sure you want to delete this file?"))try{await G.delete(s),z.success("Media deleted successfully"),k()}catch{z.error("Failed to delete media")}},selectedIds:U,columns:{sm:2,md:3,lg:4,xl:5},aspectRatio:"square",showActions:!0,draggable:!1}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:ce.map(s=>e.jsxs("div",{onClick:()=>{u(s),y({alt:s.alt||"",caption:s.caption||""}),g(!1)},className:`rounded-xl border overflow-hidden cursor-pointer hover:shadow-xl transition-all group ${t.card} ${t.isDark?"hover:border-slate-600/50":"hover:border-gray-400"}`,children:[s.mimeType.startsWith("image/")?e.jsx("img",{src:s.path,alt:s.originalName,className:"w-full h-32 object-cover group-hover:scale-105 transition-transform"}):s.mimeType.startsWith("video/")?e.jsxs("div",{className:`w-full h-32 flex items-center justify-center relative ${t.isDark?"bg-slate-900":"bg-gray-200"}`,children:[e.jsx("video",{src:s.path,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx(me,{className:"text-white",size:32})})]}):s.mimeType.startsWith("audio/")?e.jsx("div",{className:"w-full h-32 bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx(J,{className:"text-white",size:32})}):e.jsx("div",{className:`w-full h-32 flex items-center justify-center ${t.isDark?"bg-slate-700/50":"bg-gray-200"}`,children:e.jsx(Z,{className:t.textMuted,size:32})}),e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:`text-xs truncate ${t.textPrimary}`,children:s.originalName}),e.jsx("p",{className:`text-xs ${t.textMuted}`,children:q(s.size)}),N==="all-media"&&s.uploadedBy&&e.jsxs("p",{className:`text-[10px] ${t.textMuted} truncate`,children:["by ",s.uploadedBy.name]})]})]},s.id))})]}),o&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>u(null)}),e.jsxs("div",{className:`relative rounded-2xl max-w-3xl w-full p-6 max-h-[90vh] overflow-y-auto shadow-2xl ${t.isDark?"bg-slate-800 border border-slate-700/50":"bg-white border border-gray-200"}`,children:[e.jsx("button",{onClick:()=>u(null),className:`absolute top-4 right-4 z-10 transition-colors ${t.icon} ${t.iconHover}`,children:e.jsx(xe,{size:24})}),e.jsx("h2",{className:`text-2xl font-bold mb-4 ${t.textPrimary}`,children:"Media Details"}),e.jsxs("div",{className:`mb-6 rounded-xl overflow-hidden ${t.isDark?"bg-slate-900/50":"bg-gray-100"}`,children:[o.mimeType.startsWith("image/")&&e.jsx("img",{src:o.path,alt:o.originalName,className:"w-full"}),o.mimeType.startsWith("video/")&&e.jsx("video",{src:o.path,controls:!0,className:"w-full"}),o.mimeType.startsWith("audio/")&&e.jsx("div",{className:"p-8",children:e.jsx("audio",{src:o.path,controls:!0,className:"w-full"})})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"File name:"}),e.jsx("p",{className:t.textPrimary,children:o.originalName})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"File type:"}),e.jsx("p",{className:t.textPrimary,children:o.mimeType})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"File size:"}),e.jsx("p",{className:t.textPrimary,children:q(o.size)})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"Uploaded:"}),e.jsx("p",{className:t.textPrimary,children:new Date(o.createdAt).toLocaleString()})]}),o.uploadedBy&&e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"Uploaded by:"}),e.jsxs("p",{className:t.textPrimary,children:[o.uploadedBy.name," (",o.uploadedBy.email,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${t.textMuted}`,children:"URL:"}),e.jsx("input",{type:"text",value:`http://localhost:3000${o.path}`,readOnly:!0,className:`w-full mt-1 px-3 py-2 rounded-lg text-sm ${t.input}`,onClick:s=>s.currentTarget.select()})]})]}),e.jsxs("div",{className:`border-t pt-6 mb-6 ${t.border}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold ${t.textPrimary}`,children:"Metadata"}),!P&&e.jsx("button",{onClick:()=>g(!0),className:"text-blue-400 hover:text-blue-300 text-sm transition-colors",children:"Edit"})]}),P?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t.textMuted}`,children:"Alt Text"}),e.jsx("input",{type:"text",value:A.alt,onChange:s=>y({...A,alt:s.target.value}),className:`w-full px-3 py-2 rounded-lg ${t.input}`,placeholder:"Describe this image for accessibility"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t.textMuted}`,children:"Caption"}),e.jsx("textarea",{value:A.caption,onChange:s=>y({...A,caption:s.target.value}),className:`w-full px-3 py-2 rounded-lg ${t.input}`,rows:3,placeholder:"Add a caption"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:de,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-500 hover:to-blue-400 transition-all",children:"Save Metadata"}),e.jsx("button",{onClick:()=>{g(!1),y({alt:o.alt||"",caption:o.caption||""})},className:`px-4 py-2 border rounded-lg transition-all ${t.border} ${t.textMuted} ${t.isDark?"hover:bg-slate-700/50 hover:text-white":"hover:bg-gray-100 hover:text-gray-900"}`,children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium ${t.textMuted}`,children:"Alt Text:"}),e.jsx("p",{className:t.textPrimary,children:o.alt||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium ${t.textMuted}`,children:"Caption:"}),e.jsx("p",{className:t.textPrimary,children:o.caption||"Not set"})]})]})]}),e.jsxs("div",{className:`flex gap-3 border-t pt-6 ${t.border}`,children:[e.jsxs("a",{href:o.path,download:o.originalName,className:`flex items-center px-4 py-2 border rounded-lg transition-all ${t.border} ${t.textMuted} ${t.isDark?"hover:bg-slate-700/50 hover:text-white":"hover:bg-gray-100 hover:text-gray-900"}`,children:[e.jsx(Je,{className:"mr-2",size:18}),"Download"]}),e.jsxs("button",{onClick:()=>v({isOpen:!0,mediaId:o.id}),className:"flex items-center px-4 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 hover:text-red-300 transition-all",children:[e.jsx(ze,{className:"mr-2",size:18}),"Delete"]})]})]})]})}),e.jsx(tt,{isOpen:C.isOpen,title:"Delete Media",message:"Are you sure you want to delete this media file? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",variant:"danger",onConfirm:()=>C.mediaId&&_(C.mediaId),onCancel:()=>v({isOpen:!1,mediaId:null})})]})}export{Dt as default};
