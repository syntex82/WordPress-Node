import{h as C,r,j as e,L as Q}from"./vendor-react-D2QycniR.js";import{c9 as i}from"./index-Bpp1ZX0C.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";const A=[{value:"MCQ",label:"Multiple Choice (Single)"},{value:"MCQ_MULTI",label:"Multiple Choice (Multiple)"},{value:"TRUE_FALSE",label:"True/False"},{value:"SHORT_ANSWER",label:"Short Answer"},{value:"ESSAY",label:"Essay"}];function T(){var b;const{courseId:n,quizId:c}=C(),[a,g]=r.useState(null),[v,j]=r.useState(!0),[w,d]=r.useState(!1),[t,l]=r.useState(null),[p,u]=r.useState("");r.useEffect(()=>{x()},[c]);const x=async()=>{try{const{data:s}=await i.getQuiz(n,c);g(s)}catch(s){console.error("Failed to load quiz:",s)}finally{j(!1)}},N=async()=>{if(t!=null&&t.prompt)try{const s=p.split(`
`).filter(Boolean),o={...t,optionsJson:s.length>0?s:void 0};t.id?await i.updateQuestion(n,t.id,o):await i.addQuestion(n,c,o),d(!1),l(null),x()}catch(s){console.error("Failed to save question:",s)}},y=async s=>{if(confirm("Delete this question?"))try{await i.deleteQuestion(n,s),x()}catch(o){console.error("Failed to delete question:",o)}},h=s=>{s?(l(s),u((s.optionsJson||[]).join(`
`))):(l({type:"MCQ",prompt:"",points:1,correctAnswerJson:""}),u("")),d(!0)};return v?e.jsx("div",{className:"p-4 md:p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-slate-700 border-t-blue-500"})}):e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(Q,{to:`/lms/courses/${n}/quizzes`,className:"text-blue-400 hover:text-blue-300 text-sm transition-colors",children:"← Back to Quizzes"}),e.jsxs("h1",{className:"text-xl md:text-2xl font-bold bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent line-clamp-2",children:[a==null?void 0:a.title," - Questions"]})]}),e.jsx("button",{onClick:()=>h(),className:"w-full sm:w-auto bg-gradient-to-r from-blue-600 to-blue-500 text-white px-4 py-2.5 rounded-xl hover:from-blue-700 hover:to-blue-600 shadow-lg shadow-blue-500/20 transition-all",children:"Add Question"})]}),e.jsx("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50",children:(b=a==null?void 0:a.questions)!=null&&b.length?e.jsx("ul",{className:"divide-y divide-slate-700/50",children:a.questions.map((s,o)=>e.jsx("li",{className:"p-3 md:p-4 hover:bg-slate-700/30 transition-colors",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-slate-500",children:["Q",o+1]}),e.jsx("span",{className:"text-xs bg-slate-700/50 text-slate-300 px-2 py-0.5 rounded",children:s.type}),e.jsxs("span",{className:"text-xs text-slate-500",children:[s.points," pts"]})]}),e.jsx("div",{className:"font-medium text-white break-words",children:s.prompt}),s.optionsJson&&e.jsx("ul",{className:"mt-2 text-sm text-slate-400 ml-4",children:s.optionsJson.map((m,f)=>e.jsxs("li",{className:`break-words ${m===s.correctAnswerJson?"text-green-400 font-medium":""}`,children:[String.fromCharCode(65+f),". ",m," ",m===s.correctAnswerJson&&"✓"]},f))})]}),e.jsxs("div",{className:"flex gap-2 ml-auto sm:ml-0",children:[e.jsx("button",{onClick:()=>h(s),className:"text-blue-400 hover:text-blue-300 px-2 md:px-3 py-1 transition-colors text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>y(s.id),className:"text-red-400 hover:text-red-300 px-2 md:px-3 py-1 transition-colors text-sm",children:"Delete"})]})]})},s.id))}):e.jsx("div",{className:"p-8 text-center text-slate-400",children:"No questions yet. Add your first question!"})}),w&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700/50 p-4 md:p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold mb-4 text-white",children:t.id?"Edit Question":"Add Question"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Type"}),e.jsx("select",{value:t.type,onChange:s=>l({...t,type:s.target.value}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:A.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Points"}),e.jsx("input",{type:"number",value:t.points||1,onChange:s=>l({...t,points:parseInt(s.target.value)}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",min:"1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Question *"}),e.jsx("textarea",{value:t.prompt||"",onChange:s=>l({...t,prompt:s.target.value}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 h-20 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),["MCQ","MCQ_MULTI"].includes(t.type||"")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Options (one per line)"}),e.jsx("textarea",{value:p,onChange:s=>u(s.target.value),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 h-24 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:`Option A
Option B
Option C`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Correct Answer"}),t.type==="TRUE_FALSE"?e.jsxs("select",{value:String(t.correctAnswerJson),onChange:s=>l({...t,correctAnswerJson:s.target.value==="true"}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]}):e.jsx("input",{type:"text",value:t.correctAnswerJson||"",onChange:s=>l({...t,correctAnswerJson:s.target.value}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"Enter correct answer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-slate-300",children:"Explanation (shown after answer)"}),e.jsx("textarea",{value:t.explanation||"",onChange:s=>l({...t,explanation:s.target.value}),className:"w-full bg-slate-700/50 border border-slate-600/50 rounded-xl px-3 py-2 h-16 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 mt-6",children:[e.jsx("button",{onClick:()=>d(!1),className:"w-full sm:w-auto px-4 py-2.5 border border-slate-600/50 rounded-xl text-slate-300 hover:bg-slate-700/50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:N,className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 shadow-lg shadow-blue-500/20 transition-all",children:"Save"})]})]})})]})}export{T as default};
