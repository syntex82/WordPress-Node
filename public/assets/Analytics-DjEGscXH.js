import{r as i,j as e}from"./vendor-react-D2QycniR.js";import{x as T,bL as d,T as y,c as F,ay as C,M as z,b as E,d as D,o as I,z as q,ar as H,aN as O,aO as U}from"./index-JNkgy8O1.js";import{L as Y}from"./LoadingSpinner-BUnjBwPP.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";const h={refresh:{title:"Refresh Data",content:"Reload analytics data from the server."},period:{title:"Time Period",content:"Select the date range for analytics data."}};function W(){var R,V;const s=T(),[p,u]=i.useState(!0),[l,x]=i.useState("week"),[n,N]=i.useState(null),[r,w]=i.useState([]),[b,$]=i.useState([]),[g,P]=i.useState([]),[o,j]=i.useState(null),A=async()=>{var t,a;try{u(!0);const[c,v,f,M,k]=await Promise.all([d.getDashboard(l),d.getPageViews(l),d.getTopPages(l,10),d.getDevices(l),d.getRealtime()]);N(c.data||{pageViews:0,uniqueVisitors:0,sessions:0,avgDuration:0,bounceRate:0}),w(v.data||[]),$(f.data||[]),P(M.data||[]),j(k.data||{activeVisitors:0,recentPages:[]})}catch(c){N({pageViews:0,uniqueVisitors:0,sessions:0,avgDuration:0,bounceRate:0}),w([]),$([]),P([]),j({activeVisitors:0,recentPages:[]}),q.error(((a=(t=c.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load analytics data"),console.error("Analytics error:",c)}finally{u(!1)}};i.useEffect(()=>{A()},[l]),i.useEffect(()=>{const t=setInterval(async()=>{try{const a=await d.getRealtime();j(a.data)}catch{}},3e4);return()=>clearInterval(t)},[]);const S=t=>{if(t<60)return`${t}s`;const a=Math.floor(t/60),c=t%60;return`${a}m ${c}s`},L=t=>{switch(t==null?void 0:t.toLowerCase()){case"mobile":return e.jsx(U,{className:"text-blue-400"});case"tablet":return e.jsx(O,{className:"text-emerald-400"});default:return e.jsx(H,{className:"text-slate-400"})}};return p?e.jsx(Y,{}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:`text-3xl font-bold ${s.titleGradient}`,children:"Analytics Dashboard"}),e.jsx(y,{title:"About Analytics",content:"Track your site's performance with detailed visitor statistics, page views, and device breakdowns.",position:"right",variant:"help",children:e.jsx("button",{className:`p-1 ${s.icon} hover:text-blue-400`,children:e.jsx(F,{size:18})})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{title:h.period.title,content:h.period.content,position:"bottom",children:e.jsxs("select",{value:l,onChange:t=>x(t.target.value),className:`rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500/50 ${s.select}`,children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"year",children:"Last Year"})]})}),e.jsx(y,{title:h.refresh.title,content:h.refresh.content,position:"left",children:e.jsx("button",{onClick:A,className:`p-2 border rounded-lg transition-all ${s.border} ${s.icon} ${s.iconHover}`,children:e.jsx(C,{size:20})})})]})]}),o&&e.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-4 mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-emerald-400 font-medium",children:[o.activeVisitors," active visitor",o.activeVisitors!==1?"s":""," right now"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(m,{icon:e.jsx(z,{}),label:"Page Views",value:(n.pageViews||0).toLocaleString(),color:"blue"}),e.jsx(m,{icon:e.jsx(E,{}),label:"Unique Visitors",value:(n.uniqueVisitors||0).toLocaleString(),color:"green"}),e.jsx(m,{icon:e.jsx(D,{}),label:"Sessions",value:(n.sessions||0).toLocaleString(),color:"purple"}),e.jsx(m,{icon:e.jsx(I,{}),label:"Avg. Duration",value:S(n.avgDuration||0),color:"orange"}),e.jsx(m,{icon:e.jsx(D,{}),label:"Bounce Rate",value:`${n.bounceRate||0}%`,color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:`backdrop-blur rounded-xl border p-6 ${s.card}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${s.textPrimary}`,children:"Page Views Over Time"}),e.jsx("div",{className:"h-48 flex items-end gap-1",children:!Array.isArray(r)||r.length===0?e.jsx("p",{className:`text-center w-full ${s.textMuted}`,children:"No data available"}):r.map((t,a)=>{const c=Math.max(...r.map(f=>f.views||0),1),v=(t.views||0)/c*100;return e.jsxs("div",{className:"flex-1 flex flex-col items-center group relative",children:[e.jsx("div",{className:"w-full bg-gradient-to-t from-blue-600 to-blue-400 hover:from-blue-500 hover:to-blue-300 rounded-t transition-colors cursor-pointer",style:{height:`${v}%`,minHeight:"4px"}}),e.jsxs("div",{className:"hidden group-hover:block absolute bottom-full mb-2 bg-slate-900 text-white text-xs px-2 py-1 rounded whitespace-nowrap border border-slate-700/50",children:[t.date,": ",t.views||0," views"]})]},a)})}),Array.isArray(r)&&r.length>0&&e.jsxs("div",{className:`flex justify-between text-xs mt-2 ${s.textMuted}`,children:[e.jsx("span",{children:((R=r[0])==null?void 0:R.date)||""}),e.jsx("span",{children:((V=r[r.length-1])==null?void 0:V.date)||""})]})]}),e.jsxs("div",{className:`backdrop-blur rounded-xl border p-6 ${s.card}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${s.textPrimary}`,children:"Devices"}),!Array.isArray(g)||g.length===0?e.jsx("p",{className:`text-center py-8 ${s.textMuted}`,children:"No data available"}):e.jsx("div",{className:"space-y-4",children:g.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:L(t.device)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:`font-medium capitalize ${s.textPrimary}`,children:t.device||"Unknown"}),e.jsxs("span",{className:s.textMuted,children:[t.count||0," (",t.percentage||0,"%)"]})]}),e.jsx("div",{className:`h-2 rounded-full overflow-hidden ${s.isDark?"bg-slate-700/50":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-blue-400 rounded-full",style:{width:`${t.percentage||0}%`}})})]})]},t.device||a))})]})]}),e.jsxs("div",{className:`backdrop-blur rounded-xl border overflow-hidden mb-8 ${s.card}`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${s.border}`,children:e.jsx("h3",{className:`text-lg font-semibold ${s.textPrimary}`,children:"Top Pages"})}),!Array.isArray(b)||b.length===0?e.jsx("p",{className:`text-center py-8 ${s.textMuted}`,children:"No data available"}):e.jsxs("table",{className:`min-w-full divide-y ${s.border}`,children:[e.jsx("thead",{className:s.tableHeader,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase ${s.textMuted}`,children:"Page"}),e.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium uppercase ${s.textMuted}`,children:"Views"}),e.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium uppercase ${s.textMuted}`,children:"Avg. Time"})]})}),e.jsx("tbody",{className:`divide-y ${s.border}`,children:b.map((t,a)=>e.jsxs("tr",{className:s.tableRow,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`font-medium ${s.textPrimary}`,children:t.path||"/"})}),e.jsx("td",{className:`px-6 py-4 text-right ${s.textMuted}`,children:(t.views||0).toLocaleString()}),e.jsx("td",{className:`px-6 py-4 text-right ${s.textMuted}`,children:S(t.avgDuration||0)})]},a))})]})]}),o&&Array.isArray(o.recentPages)&&o.recentPages.length>0&&e.jsxs("div",{className:`backdrop-blur rounded-xl border overflow-hidden ${s.card}`,children:[e.jsxs("div",{className:`px-6 py-4 border-b flex items-center gap-2 ${s.border}`,children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("h3",{className:`text-lg font-semibold ${s.textPrimary}`,children:"Live Activity"})]}),e.jsx("div",{className:`divide-y ${s.border}`,children:o.recentPages.map((t,a)=>e.jsxs("div",{className:`px-6 py-3 flex justify-between items-center ${s.tableRow}`,children:[e.jsx("span",{className:s.textPrimary,children:t.path||"/"}),e.jsx("span",{className:`text-sm ${s.textMuted}`,children:t.createdAt?new Date(t.createdAt).toLocaleTimeString():""})]},a))})]})]})}function m({icon:s,label:p,value:u,color:l}){const x=T(),n={blue:"bg-blue-500/20 text-blue-400",green:"bg-emerald-500/20 text-emerald-400",purple:"bg-purple-500/20 text-purple-400",orange:"bg-amber-500/20 text-amber-400",red:"bg-red-500/20 text-red-400"};return e.jsx("div",{className:`backdrop-blur rounded-xl border p-4 ${x.card}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${n[l]}`,children:s}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${x.textMuted}`,children:p}),e.jsx("p",{className:`text-2xl font-bold ${x.textPrimary}`,children:u})]})]})})}export{W as default};
