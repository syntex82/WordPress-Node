import{h as S,d as L,a as _,r as l,j as e}from"./vendor-react-D2QycniR.js";import{aa as q,ce as h,c6 as D,z as o,C as H,V as I,aP as R,bA as T,k as $,o as Y,b as z}from"./index-JNkgy8O1.js";import"./vendor-editor-Cn7QR8gj.js";import"./vendor-utils-BWf5C302.js";import"./vendor-socket-CA1CrNgP.js";function W(){var N,y,w,v,C,k;const{slug:a}=S(),[g]=L(),n=_(),{isAuthenticated:f}=q(),[s,A]=l.useState(null),[c,b]=l.useState(!0),[d,i]=l.useState(!1),[m,x]=l.useState(!1),j=l.useRef(!1);l.useEffect(()=>{P()},[a]),l.useEffect(()=>{s&&!c&&g.get("enroll")==="true"&&!j.current&&!m&&(j.current=!0,p())},[s,c,g,m]);const P=async()=>{if(!a){console.error("No slug provided"),b(!1);return}try{console.log("Loading course:",a);const{data:t}=await h.getCourse(a);if(console.log("Course loaded:",t),A(t),f&&(t!=null&&t.id))try{await h.getEnrollment(t.id),x(!0)}catch{x(!1)}}catch(t){console.error("Failed to load course:",t)}finally{b(!1)}},p=async()=>{var t,r,E,F;if(!f){n("/login");return}if(s){if(s.priceType==="PAID"&&s.priceAmount&&s.priceAmount>0){i(!0);try{await D.addCourse(s.id),o.success("Course added to cart!"),n("/cart")}catch(u){o.error(((r=(t=u.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to add to cart")}finally{i(!1)}return}i(!0);try{await h.enroll(s.id),x(!0),o.success("Successfully enrolled!"),n(`/lms/learn/${s.id}`)}catch(u){o.error(((F=(E=u.response)==null?void 0:E.data)==null?void 0:F.message)||"Failed to enroll")}finally{i(!1)}}};return c?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-slate-700 border-t-blue-500"})}):s?e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white py-8 md:py-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 md:gap-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 md:mb-4",children:[s.level&&e.jsx("span",{className:"bg-white/20 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm",children:s.level.replace("_"," ")}),s.category&&e.jsx("span",{className:"bg-white/20 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm",children:s.category})]}),e.jsx("h1",{className:"text-2xl md:text-4xl font-bold mb-3 md:mb-4",children:s.title}),e.jsx("p",{className:"text-base md:text-xl opacity-90 mb-4 md:mb-6",children:s.shortDescription}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 md:gap-6 text-xs md:text-sm",children:[e.jsxs("span",{children:["ðŸ‘¤ ",(N=s.instructor)==null?void 0:N.name]}),e.jsxs("span",{children:["ðŸ“š ",((y=s._count)==null?void 0:y.lessons)||0," lessons"]}),s.estimatedHours&&e.jsxs("span",{children:["â±ï¸ ",s.estimatedHours," hours"]}),e.jsxs("span",{children:["ðŸ‘¥ ",((w=s._count)==null?void 0:w.enrollments)||0," students"]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-xl md:rounded-2xl p-4 md:p-6 text-white shadow-2xl border border-slate-700/50",children:[e.jsx("img",{src:s.featuredImage||"/api/lms/courses/placeholder-image",alt:"",className:"w-full h-32 md:h-40 object-cover rounded-lg md:rounded-xl mb-4",onError:t=>{t.target.src="/api/lms/courses/placeholder-image"}}),e.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-4",children:s.priceType==="PAID"?`$${Number(s.priceAmount||0).toFixed(2)}`:"Free"}),m?e.jsxs("button",{onClick:()=>n(`/lms/learn/${s.id}`),className:"w-full bg-gradient-to-r from-green-600 to-green-500 text-white py-3 rounded-xl font-semibold hover:from-green-700 hover:to-green-600 flex items-center justify-center gap-2 transition-colors shadow-lg shadow-green-500/20",children:[e.jsx(H,{})," Continue Learning"]}):s.priceType==="FREE"?e.jsx("button",{onClick:p,disabled:d,className:"w-full bg-gradient-to-r from-blue-600 to-blue-500 text-white py-3 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-600 disabled:opacity-50 flex items-center justify-center gap-2 transition-colors shadow-lg shadow-blue-500/20",children:d?"Enrolling...":e.jsxs(e.Fragment,{children:[e.jsx(I,{})," Enroll for Free"]})}):e.jsx("button",{onClick:p,disabled:d,className:"w-full bg-gradient-to-r from-purple-600 to-purple-500 text-white py-3 rounded-xl font-semibold hover:from-purple-700 hover:to-purple-600 disabled:opacity-50 flex items-center justify-center gap-2 transition-colors shadow-lg shadow-purple-500/20",children:d?"Adding to Cart...":e.jsxs(e.Fragment,{children:[e.jsx(R,{})," Add to Cart"]})}),e.jsxs("div",{className:"mt-4 space-y-2 text-xs md:text-sm text-slate-300",children:[s.certificateEnabled&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"text-yellow-400 flex-shrink-0"})," Certificate on completion"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx($,{className:"flex-shrink-0"})," ",((v=s._count)==null?void 0:v.lessons)||0," lessons"]}),s.estimatedHours&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"flex-shrink-0"})," ",s.estimatedHours," hours of content"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"flex-shrink-0"})," ",((C=s._count)==null?void 0:C.enrollments)||0," students enrolled"]})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8 md:py-12",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 md:gap-8",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6 md:space-y-8",children:[s.whatYouLearn&&s.whatYouLearn.length>0&&e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-4 md:p-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4",children:"What you'll learn"}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3",children:s.whatYouLearn.map((t,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm md:text-base text-slate-300",children:[e.jsx("span",{className:"text-green-400 flex-shrink-0",children:"âœ“"}),e.jsx("span",{children:t})]},r))})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-4 md:p-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4",children:"Description"}),e.jsx("div",{className:"prose prose-invert max-w-none text-slate-300 text-sm md:text-base",children:s.description})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-4 md:p-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white mb-3 md:mb-4",children:"Curriculum"}),e.jsx("ul",{className:"divide-y divide-slate-700/50",children:(k=s.lessons)==null?void 0:k.map((t,r)=>e.jsxs("li",{className:"py-2 md:py-3 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 min-w-0",children:[e.jsx("span",{className:"text-slate-500 flex-shrink-0",children:r+1}),e.jsx("span",{className:"text-slate-300 text-sm md:text-base truncate",children:t.title}),t.isPreview&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded-lg whitespace-nowrap",children:"Preview"})]}),e.jsxs("span",{className:"text-xs md:text-sm text-slate-500 whitespace-nowrap",children:[t.estimatedMinutes," min"]})]},t.id))})]})]}),e.jsx("div",{className:"space-y-4 md:space-y-6",children:s.requirements&&s.requirements.length>0&&e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur rounded-xl border border-slate-700/50 p-4 md:p-6",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Requirements"}),e.jsx("ul",{className:"space-y-2 text-xs md:text-sm text-slate-400",children:s.requirements.map((t,r)=>e.jsxs("li",{children:["â€¢ ",t]},r))})]})})]})})]}):e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center text-slate-400",children:"Course not found"})}export{W as default};
